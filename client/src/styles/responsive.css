/* =============================================
   RESPONSIVE DESIGN UTILITIES & MEDIA QUERIES
   Mobile-first approach for iNaturaQuizz
   ============================================= */

/* ─────────────────────────────────────────────
   BREAKPOINTS (Mobile-first)
   ───────────────────────────────────────────── */

/*
  MOBILE:     320px - 639px  (phones)
  TABLET:     640px - 1023px (iPads, small tablets)
  DESKTOP:    1024px+        (desktops, large screens)
  
  We use max-width for progressively enhanced styles,
  starting mobile-first in base styles.
*/

/* ─────────────────────────────────────────────
   TOUCH TARGETS (Mobile-first accessibility)
   ───────────────────────────────────────────── */

/* Ensure interactive elements are 44x44px minimum */
button,
a[role="button"],
input[type="button"],
input[type="submit"],
.clickable:not(.app-title-image),
.hero-cta,
.home-chip,
.hero-abandon {
  min-height: 44px;
  min-width: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Increase padding on mobile for better touch targets */
@media (max-width: 640px) {
  button,
  a[role="button"],
  input[type="button"],
  input[type="submit"],
  .clickable:not(.app-title-image) {
    padding: 0.75rem 1rem; /* Minimum 44px tall */
  }
}

/* ─────────────────────────────────────────────
   HERO CTA BUTTON (Mobile adjustments)
   ───────────────────────────────────────────── */

@media (max-width: 640px) {
  .hero-cta {
    width: 100%;
    padding: 1.25rem 1rem; /* Better touch target */
  }

  .hero-cta-group {
    flex-wrap: nowrap;
    gap: 0.5rem;
  }

  .hero-cta-group .hero-cta {
    flex: 1;
    min-height: 48px;
  }

  .hero-abandon {
    width: 48px;
    min-width: 48px;
    min-height: 48px;
  }

  /* Ensure text is readable */
  .hero-cta .cta-label {
    font-size: 1rem;
    font-weight: 600;
  }

  .hero-cta .cta-sublabel {
    font-size: 0.85rem;
    opacity: 0.85;
  }
}

/* ─────────────────────────────────────────────
   IMAGE VIEWER (Responsive image handling)
   ───────────────────────────────────────────── */

@media (max-width: 768px) {
  .image-viewer,
  .game-image,
  img.species-image {
    width: 100%;
    max-width: 100%;
    height: auto;
    object-fit: contain;
    border-radius: 12px;
  }

  .image-container {
    width: 100%;
    max-height: 60vh;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    border-radius: 12px;
  }
}

/* ─────────────────────────────────────────────
   STATS LAYOUT (Profile, End screen)
   ───────────────────────────────────────────── */

@media (max-width: 768px) {
  /* Stats should stack vertically on mobile */
  .stats-grid,
  .profile-stats,
  .end-stats {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    width: 100%;
  }

  .stats-grid > *,
  .profile-stats > *,
  .end-stats > * {
    width: 100%;
  }

  /* Ensure stat items are readable */
  .stat-item,
  .profile-stat-card,
  .end-stat-card {
    padding: 1rem;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    min-height: 60px;
  }

  .stat-label {
    font-size: 0.9rem;
  }

  .stat-value {
    font-size: 1.4rem;
    font-weight: 700;
  }
}

/* ─────────────────────────────────────────────
   BADGES & GRID COMPONENTS (Responsive wrapping)
   ───────────────────────────────────────────── */

@media (max-width: 768px) {
  .badge-container,
  .achievement-grid,
  .badge-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 0.75rem;
    justify-content: flex-start;
  }

  .badge,
  .badge-item,
  .achievement-badge {
    flex: 0 1 calc(50% - 0.375rem); /* 2 columns on mobile */
    min-height: 80px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
  }

  .badge-icon {
    font-size: 1.8rem;
  }

  .badge-label {
    font-size: 0.75rem;
    text-align: center;
    max-width: 100%;
  }
}

/* ─────────────────────────────────────────────
   MODALS & OVERLAYS (Full-screen on mobile)
   ───────────────────────────────────────────── */

@media (max-width: 768px) {
  .modal-content,
  .popover,
  .bottom-sheet {
    max-height: 90vh;
    max-width: 100%;
    border-radius: 16px 16px 0 0; /* Bottom sheet style */
    overflow-y: auto;
    -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
  }

  .modal-header {
    position: sticky;
    top: 0;
    z-index: 10;
    background: inherit;
  }

  .modal-close {
    padding: 0.75rem;
    font-size: 1.5rem;
  }
}

/* ─────────────────────────────────────────────
   FORMS & INPUTS (Mobile-friendly)
   ───────────────────────────────────────────── */

@media (max-width: 768px) {
  input,
  select,
  textarea {
    font-size: 16px; /* Prevents auto-zoom on iOS */
    padding: 0.75rem;
    border-radius: 8px;
    width: 100%;
  }

  label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600;
    font-size: 0.95rem;
  }

  .form-group {
    margin-bottom: 1.5rem;
  }

  /* Toggle switches */
  .toggle-switch {
    height: 32px;
    width: 56px;
  }
}

/* ─────────────────────────────────────────────
   TEXT SIZING (Mobile readability)
   ───────────────────────────────────────────── */

@media (max-width: 640px) {
  h1 {
    font-size: clamp(1.5rem, 5vw, 2rem);
    line-height: 1.2;
  }

  h2 {
    font-size: clamp(1.25rem, 4vw, 1.75rem);
    line-height: 1.3;
  }

  h3 {
    font-size: clamp(1.1rem, 3vw, 1.3rem);
    line-height: 1.4;
  }

  p,
  .body-text {
    font-size: clamp(0.95rem, 2.5vw, 1rem);
    line-height: 1.5;
  }

  /* Small text shouldn't go below 12px */
  .small-text,
  .caption,
  .helper-text {
    font-size: max(0.8rem, 10px);
    line-height: 1.4;
  }
}

/* Tablet adjustments */
@media (min-width: 641px) and (max-width: 1023px) {
  h1 {
    font-size: 1.75rem;
  }

  h2 {
    font-size: 1.5rem;
  }

  h3 {
    font-size: 1.25rem;
  }
}

/* ─────────────────────────────────────────────
   SPACING (Responsive margins & padding)
   ───────────────────────────────────────────── */

@media (max-width: 640px) {
  /* Base container padding */
  .container,
  .screen,
  main {
    padding: 1rem;
  }

  /* Reduce spacing on small screens */
  .gap-lg {
    gap: 1rem;
  }

  .gap-md {
    gap: 0.75rem;
  }

  .gap-sm {
    gap: 0.5rem;
  }

  /* Section spacing */
  section {
    margin-bottom: 1.5rem;
  }
}

/* ─────────────────────────────────────────────
   SCROLL BEHAVIOR (Mobile smoothness)
   ───────────────────────────────────────────── */

@media (max-width: 768px) {
  html {
    scroll-behavior: smooth;
    -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
  }

  /* Native-like scrolling on iOS */
  .scrollable,
  .overflow-scroll {
    -webkit-overflow-scrolling: touch;
    overflow-y: auto;
  }

  /* Reduce motion for accessibility */
  @media (prefers-reduced-motion: reduce) {
    * {
      animation: none !important;
      transition: none !important;
    }
  }
}

/* ─────────────────────────────────────────────
   NAVIGATION (Mobile bottom nav support)
   ───────────────────────────────────────────── */

@media (max-width: 768px) {
  /* Space for fixed bottom navigation */
  main,
  .screen-content {
    padding-bottom: calc(1rem + var(--nav-height-mobile, 75px));
  }

  nav {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 100;
  }

  /* Ensure nav is accessible */
  .nav-item {
    min-height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex: 1;
    gap: 0.5rem;
  }
}

/* ─────────────────────────────────────────────
   CARDS & SECTIONS (Mobile optimization)
   ───────────────────────────────────────────── */

@media (max-width: 768px) {
  .card,
  .section,
  .panel {
    border-radius: 12px;
    padding: 1rem;
    width: 100%;
  }

  .card-grid,
  .section-grid {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .card-header,
  .section-header {
    margin-bottom: 1rem;
  }
}

/* Tablet layout: 2 columns */
@media (min-width: 641px) and (max-width: 1023px) {
  .card-grid,
  .section-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1.25rem;
  }
}

/* Desktop layout: 3+ columns */
@media (min-width: 1024px) {
  .card-grid,
  .section-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
  }
}

/* ─────────────────────────────────────────────
   LANDSCAPE MODE (Small phones in horizontal)
   ───────────────────────────────────────────── */

@media (max-height: 600px) and (orientation: landscape) {
  /* Reduce vertical spacing in landscape */
  .container,
  .screen {
    padding: 0.75rem;
  }

  h1, h2, h3 {
    margin-bottom: 0.5rem;
  }

  .gap-lg {
    gap: 0.5rem;
  }

  /* Ensure content is visible */
  main {
    max-height: 100vh;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }
}

/* ─────────────────────────────────────────────
   HIGH DPI / RETINA DISPLAYS
   ───────────────────────────────────────────── */

@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  /* High-DPI tweaks intentionally scoped; no global borders */
}

/* ─────────────────────────────────────────────
   NOTCH SUPPORT (iPhone X+)
   ───────────────────────────────────────────── */

/* Add safe-area insets for devices with notches */
@supports (padding: max(0px)) {
  .safe-top {
    padding-top: max(1rem, env(safe-area-inset-top));
  }

  .safe-bottom {
    padding-bottom: max(1rem, env(safe-area-inset-bottom));
  }

  .safe-left {
    padding-left: max(1rem, env(safe-area-inset-left));
  }

  .safe-right {
    padding-right: max(1rem, env(safe-area-inset-right));
  }
}

/* ─────────────────────────────────────────────
   DARK MODE (Already used, but for clarity)
   ───────────────────────────────────────────── */

@media (prefers-color-scheme: dark) {
  /* Your dark colors are already set in App.css */
  /* This is included for reference */
}

/* ─────────────────────────────────────────────
   LIGHT MODE (If user has light preference)
   ───────────────────────────────────────────── */

@media (prefers-color-scheme: light) {
  /* Define light mode colors here if needed */
}

/* ─────────────────────────────────────────────
   PRINT MEDIA (For accessibility)
   ───────────────────────────────────────────── */

@media print {
  body {
    background: white;
    color: black;
  }

  .no-print {
    display: none !important;
  }

  a {
    text-decoration: underline;
  }
}
